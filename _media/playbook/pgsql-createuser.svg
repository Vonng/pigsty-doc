<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 --><!-- Title: pgsql&#45;createuser.yml  Pages: 1 --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1459pt" height="466pt" viewBox="0.00 0.00 1458.80 465.55" id="svg">
<script type="text/javascript" href="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js" id="jquery"/><script type="text/javascript" id="my_javascript"><![CDATA[const HOVER_CLASS = "my_hover";

var selectedElement = null;

function addClass(rootElement) {
    $(rootElement).find('link').each(function (index, element) {
        var target = $(element).attr('target');
        var currentElement = $('#' + target);
        currentElement.addClass(HOVER_CLASS);

        addClass(currentElement);
    })
}

function removeClass(rootElement, hover) {
    $(rootElement).find('link').each(function (index, element) {
        if ($(rootElement).attr('id') !== $(selectedElement).attr('id') || !hover) {
            var target = $(element).attr('target');
            var currentElement = $('#' + target);
            currentElement.removeClass(HOVER_CLASS);

            removeClass(currentElement);
        }

    })
}

function hoverIn(event) {
    addClass(event.currentTarget);
}

function hoverOut(event) {
    removeClass(event.currentTarget, true);
}

function clickOnElement(event) {
    var newElement = event.currentTarget;

    if ($(newElement).attr('id') === $(selectedElement).attr('id')) {
        removeClass(selectedElement, false);
    } else {
        removeClass(selectedElement);
        addClass(newElement)
    }

    selectedElement = newElement;
}


$("#svg").ready(function () {

    $("g[id^=play_]").hover(hoverIn, hoverOut);
    $("g[id^=role_]").hover(hoverIn, hoverOut);

    $("g[id^=play_]").click(clickOnElement);
    $("g[id^=role_]").click(clickOnElement);

});
]]></script><style type="text/css" id="my_css"><![CDATA[.node:hover, .edge:hover, path:hover, path + polygon:hover {
    cursor: pointer;
    stroke-width: 3;
    font-weight: bolder;
}

.my_hover {
    cursor: pointer;
    stroke-width: 3;
    font-weight: bolder;
}
]]></style><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 461.55)">
<title>pgsql-createuser.yml </title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-461.55 1454.8,-461.55 1454.8,4 -4,4"/>
<!-- pgsql&#45;createuser.yml -->
<g id="root_node" class="node">
<title>pgsql-createuser.yml</title>
<ellipse fill="none" stroke="black" stroke-dasharray="1,5" cx="84.49" cy="-240.55" rx="84.49" ry="18"/>
<text text-anchor="middle" x="84.49" y="-236.85" font-family="Times,serif" font-size="14.00">pgsql-createuser.yml</text>
</g>
<!-- Play #1: Create new postgres user (4) -->
<g id="play_0fd63137-91c7-4f89-813c-5838986686b9" class="node">
<title>Play #1: Create new postgres user (4)</title>
<g id="a_play_0fd63137-91c7-4f89-813c-5838986686b9"><a xlink:title="10.10.10.10     10.10.10.11     10.10.10.12     10.10.10.13">
<polygon fill="#28a707" stroke="#28a707" points="432.99,-258.55 211.99,-258.55 211.99,-222.55 432.99,-222.55 432.99,-258.55"/>
<text text-anchor="middle" x="322.49" y="-236.85" font-family="Times,serif" font-size="14.00" fill="#ffffff">Play #1: Create new postgres user (4)</text>
</a>
</g>
<links><link target="edge_4df315dd-e905-4978-bfad-c5b76e472a85"/><link target="edge_d4ffa5f0-7dd8-4f99-8d42-640764858621"/><link target="edge_d9827873-8cb4-48c7-9edf-d49645e57057"/><link target="edge_637e3865-5b3d-4ae7-b5f9-4d3c817b2620"/><link target="edge_b576131f-fb77-4100-ab25-fd62e62cc226"/><link target="edge_7a63b9f9-534f-4ec9-b26d-b5ee0b6177a7"/><link target="edge_3f0b6716-8bda-443b-b754-f79b69d62386"/><link target="edge_a5bf1484-60cb-474d-a485-8cdc69fcdd62"/></links></g>
<!-- pgsql&#45;createuser.yml&#45;&gt;Play #1: Create new postgres user (4) -->
<g id="edge_57fa5269-6dbe-4b5d-8348-47d512039018" class="edge">
<title>pgsql-createuser.yml-&gt;Play #1: Create new postgres user (4)</title>
<path fill="none" stroke="#28a707" stroke-width="2" d="M169.03,-240.55C179.58,-240.55 190.55,-240.55 201.53,-240.55"/>
<polygon fill="#28a707" stroke="#28a707" stroke-width="2" points="201.61,-244.05 211.61,-240.55 201.61,-237.05 201.61,-244.05"/>
<text text-anchor="middle" x="190.49" y="-244.35" font-family="Times,serif" font-size="14.00" fill="#28a707">1</text>
</g>
<!-- task_c9b3e64c&#45;1dbd&#45;45dc&#45;9da7&#45;42fde0798642 -->
<g id="task_c9b3e64c-1dbd-45dc-9da7-42fde0798642" class="node">
<title>task_c9b3e64c-1dbd-45dc-9da7-42fde0798642</title>
<polygon fill="none" stroke="black" points="1307.19,-422.09 1307.19,-437 1248.73,-447.55 1166.06,-447.55 1107.6,-437 1107.6,-422.09 1166.06,-411.55 1248.73,-411.55 1307.19,-422.09"/>
<text text-anchor="middle" x="1207.39" y="-425.85" font-family="Times,serif" font-size="14.00">[task] Validate pg_user</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_c9b3e64c&#45;1dbd&#45;45dc&#45;9da7&#45;42fde0798642 -->
<g id="edge_4df315dd-e905-4978-bfad-c5b76e472a85" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_c9b3e64c-1dbd-45dc-9da7-42fde0798642</title>
<path fill="none" stroke="#28a707" stroke-width="2" d="M331.68,-258.72C348.4,-293.3 390.07,-367.88 450.99,-398.55 561.01,-453.94 915.8,-444.77 1097.27,-435.94"/>
<polygon fill="#28a707" stroke="#28a707" stroke-width="2" points="1097.56,-439.43 1107.38,-435.44 1097.22,-432.43 1097.56,-439.43"/>
<text text-anchor="middle" x="698.49" y="-446.35" font-family="Times,serif" font-size="14.00" fill="#28a707">1</text>
<links><link target="task_c9b3e64c-1dbd-45dc-9da7-42fde0798642"/></links></g>
<!-- task_b7b631f4&#45;c54b&#45;4ce4&#45;ba04&#45;8961e0b86edf -->
<g id="task_b7b631f4-c54b-4ce4-ba04-8961e0b86edf" class="node">
<title>task_b7b631f4-c54b-4ce4-ba04-8961e0b86edf</title>
<polygon fill="none" stroke="black" points="1322.23,-368.09 1322.23,-383 1254.96,-393.55 1159.83,-393.55 1092.55,-383 1092.55,-368.09 1159.83,-357.55 1254.96,-357.55 1322.23,-368.09"/>
<text text-anchor="middle" x="1207.39" y="-371.85" font-family="Times,serif" font-size="14.00">[task] Fetch user definition</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_b7b631f4&#45;c54b&#45;4ce4&#45;ba04&#45;8961e0b86edf -->
<g id="edge_d4ffa5f0-7dd8-4f99-8d42-640764858621" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_b7b631f4-c54b-4ce4-ba04-8961e0b86edf</title>
<path fill="none" stroke="#28a707" stroke-width="2" d="M339.88,-258.91C362.29,-282.53 404.98,-322.55 450.99,-339.55 563.17,-381 898.25,-381.69 1082.17,-378.63"/>
<polygon fill="#28a707" stroke="#28a707" stroke-width="2" points="1082.5,-382.13 1092.43,-378.46 1082.37,-375.13 1082.5,-382.13"/>
<text text-anchor="middle" x="698.49" y="-383.35" font-family="Times,serif" font-size="14.00" fill="#28a707">2</text>
<links><link target="task_b7b631f4-c54b-4ce4-ba04-8961e0b86edf"/></links></g>
<!-- task_141b4584&#45;d5fb&#45;44f5&#45;92f6&#45;0f0022206ca4 -->
<g id="task_141b4584-d5fb-44f5-92f6-0f0022206ca4" class="node">
<title>task_141b4584-d5fb-44f5-92f6-0f0022206ca4</title>
<polygon fill="none" stroke="black" points="1324.86,-314.09 1324.86,-329 1256.05,-339.55 1158.74,-339.55 1089.93,-329 1089.93,-314.09 1158.74,-303.55 1256.05,-303.55 1324.86,-314.09"/>
<text text-anchor="middle" x="1207.39" y="-317.85" font-family="Times,serif" font-size="14.00">[task] Check user definition</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_141b4584&#45;d5fb&#45;44f5&#45;92f6&#45;0f0022206ca4 -->
<g id="edge_d9827873-8cb4-48c7-9edf-d49645e57057" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_141b4584-d5fb-44f5-92f6-0f0022206ca4</title>
<path fill="none" stroke="#28a707" stroke-width="2" d="M374.02,-258.56C397.17,-266.05 425.16,-274.03 450.99,-278.55 669.49,-316.79 928.43,-323.29 1079.38,-323.29"/>
<polygon fill="#28a707" stroke="#28a707" stroke-width="2" points="1079.61,-326.79 1089.61,-323.28 1079.6,-319.79 1079.61,-326.79"/>
<text text-anchor="middle" x="698.49" y="-324.35" font-family="Times,serif" font-size="14.00" fill="#28a707">3</text>
<links><link target="task_141b4584-d5fb-44f5-92f6-0f0022206ca4"/></links></g>
<!-- task_95268bed&#45;f70a&#45;4d36&#45;8f81&#45;f6402a6db197 -->
<g id="task_95268bed-f70a-4d36-8f81-f6402a6db197" class="node">
<title>task_95268bed-f70a-4d36-8f81-f6402a6db197</title>
<polygon fill="none" stroke="black" points="1266.58,-260.09 1266.58,-275 1231.91,-285.55 1182.88,-285.55 1148.21,-275 1148.21,-260.09 1182.88,-249.55 1231.91,-249.55 1266.58,-260.09"/>
<text text-anchor="middle" x="1207.39" y="-263.85" font-family="Times,serif" font-size="14.00">[task] debug</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_95268bed&#45;f70a&#45;4d36&#45;8f81&#45;f6402a6db197 -->
<g id="edge_637e3865-5b3d-4ae7-b5f9-4d3c817b2620" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_95268bed-f70a-4d36-8f81-f6402a6db197</title>
<path fill="none" stroke="#28a707" stroke-width="2" d="M433.08,-243.9C617.83,-249.55 986,-260.81 1138.15,-265.46"/>
<polygon fill="#28a707" stroke="#28a707" stroke-width="2" points="1138.19,-268.96 1148.3,-265.77 1138.41,-261.97 1138.19,-268.96"/>
<text text-anchor="middle" x="698.49" y="-263.35" font-family="Times,serif" font-size="14.00" fill="#28a707">4</text>
<links><link target="task_95268bed-f70a-4d36-8f81-f6402a6db197"/></links></g>
<!-- task_31f84c2f&#45;46a3&#45;4500&#45;8799&#45;9790195e4ebf -->
<g id="task_31f84c2f-46a3-4500-8799-9790195e4ebf" class="node">
<title>task_31f84c2f-46a3-4500-8799-9790195e4ebf</title>
<polygon fill="none" stroke="black" points="1402.13,-206.09 1402.13,-221 1288.06,-231.55 1126.73,-231.55 1012.66,-221 1012.66,-206.09 1126.73,-195.55 1288.06,-195.55 1402.13,-206.09"/>
<text text-anchor="middle" x="1207.39" y="-209.85" font-family="Times,serif" font-size="14.00">[task] Render user {{ user.name }} creation sql</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_31f84c2f&#45;46a3&#45;4500&#45;8799&#45;9790195e4ebf -->
<g id="edge_b576131f-fb77-4100-ab25-fd62e62cc226" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_31f84c2f-46a3-4500-8799-9790195e4ebf</title>
<path fill="none" stroke="#28a707" stroke-width="2" d="M433.29,-225.99C439.27,-225.44 445.2,-224.95 450.99,-224.55 637.25,-211.55 849.94,-209.6 1002.08,-210.44"/>
<polygon fill="#28a707" stroke="#28a707" stroke-width="2" points="1002.45,-213.94 1012.47,-210.5 1002.49,-206.94 1002.45,-213.94"/>
<text text-anchor="middle" x="698.49" y="-228.35" font-family="Times,serif" font-size="14.00" fill="#28a707">1  [when: pg_role == 'primary']</text>
<links><link target="task_31f84c2f-46a3-4500-8799-9790195e4ebf"/></links></g>
<!-- task_d1dd07a3&#45;e191&#45;43b5&#45;976b&#45;78f6dd8f2780 -->
<g id="task_d1dd07a3-e191-43b5-976b-78f6dd8f2780" class="node">
<title>task_d1dd07a3-e191-43b5-976b-78f6dd8f2780</title>
<polygon fill="none" stroke="black" points="1450.71,-152.09 1450.71,-167 1308.18,-177.55 1106.61,-177.55 964.08,-167 964.08,-152.09 1106.61,-141.55 1308.18,-141.55 1450.71,-152.09"/>
<text text-anchor="middle" x="1207.39" y="-155.85" font-family="Times,serif" font-size="14.00">[task] Execute user {{ user.name }} creation sql on primary</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_d1dd07a3&#45;e191&#45;43b5&#45;976b&#45;78f6dd8f2780 -->
<g id="edge_7a63b9f9-534f-4ec9-b26d-b5ee0b6177a7" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_d1dd07a3-e191-43b5-976b-78f6dd8f2780</title>
<path fill="none" stroke="#28a707" stroke-width="2" d="M359.86,-222.53C384.84,-211.1 419.11,-197.26 450.99,-190.55 628.5,-153.2 834.5,-147.14 986.5,-149.48"/>
<polygon fill="#28a707" stroke="#28a707" stroke-width="2" points="986.83,-152.98 996.89,-149.65 986.95,-145.98 986.83,-152.98"/>
<text text-anchor="middle" x="698.49" y="-194.35" font-family="Times,serif" font-size="14.00" fill="#28a707">2  [when: pg_role == 'primary']</text>
<links><link target="task_d1dd07a3-e191-43b5-976b-78f6dd8f2780"/></links></g>
<!-- task_d33e7e2a&#45;2b06&#45;4e07&#45;b307&#45;9c66c2f8cf12 -->
<g id="task_d33e7e2a-2b06-4e07-b307-9c66c2f8cf12" class="node">
<title>task_d33e7e2a-2b06-4e07-b307-9c66c2f8cf12</title>
<polygon fill="none" stroke="black" points="1365.06,-98.09 1365.06,-113 1272.7,-123.55 1142.09,-123.55 1049.73,-113 1049.73,-98.09 1142.09,-87.55 1272.7,-87.55 1365.06,-98.09"/>
<text text-anchor="middle" x="1207.39" y="-101.85" font-family="Times,serif" font-size="14.00">[task] Add business user to pgbouncer</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_d33e7e2a&#45;2b06&#45;4e07&#45;b307&#45;9c66c2f8cf12 -->
<g id="edge_3f0b6716-8bda-443b-b754-f79b69d62386" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_d33e7e2a-2b06-4e07-b307-9c66c2f8cf12</title>
<path fill="none" stroke="#28a707" stroke-width="2" d="M337.17,-222.55C358.28,-196.41 401.54,-148.96 450.99,-129.55 554.18,-89.04 850.26,-91.55 1039.64,-97.94"/>
<polygon fill="#28a707" stroke="#28a707" stroke-width="2" points="1039.59,-101.44 1049.7,-98.29 1039.83,-94.45 1039.59,-101.44"/>
<text text-anchor="middle" x="698.49" y="-133.35" font-family="Times,serif" font-size="14.00" fill="#28a707">3  [when: user.pgbouncer is defined and user.pgbouncer|bool]</text>
<links><link target="task_d33e7e2a-2b06-4e07-b307-9c66c2f8cf12"/></links></g>
<!-- task_ee813fcb&#45;8428&#45;4c54&#45;948f&#45;d8780a1a6356 -->
<g id="task_ee813fcb-8428-4c54-948f-d8780a1a6356" class="node">
<title>task_ee813fcb-8428-4c54-948f-d8780a1a6356</title>
<polygon fill="none" stroke="black" points="1357.99,-44.09 1357.99,-59 1269.77,-69.55 1145.02,-69.55 1056.8,-59 1056.8,-44.09 1145.02,-33.55 1269.77,-33.55 1357.99,-44.09"/>
<text text-anchor="middle" x="1207.39" y="-47.85" font-family="Times,serif" font-size="14.00">[task] Reload pgbouncer to add user</text>
</g>
<!-- Play #1: Create new postgres user (4)&#45;&gt;task_ee813fcb&#45;8428&#45;4c54&#45;948f&#45;d8780a1a6356 -->
<g id="edge_a5bf1484-60cb-474d-a485-8cdc69fcdd62" class="edge">
<title>Play #1: Create new postgres user (4)-&gt;task_ee813fcb-8428-4c54-948f-d8780a1a6356</title>
<path fill="none" stroke="#28a707" stroke-width="2" d="M330.89,-222.54C346.74,-186.66 387.75,-106.92 450.99,-74.55 672.54,38.87 980.53,-3.17 1125.21,-32.55"/>
<polygon fill="#28a707" stroke="#28a707" stroke-width="2" points="1124.84,-36.05 1135.34,-34.65 1126.26,-29.2 1124.84,-36.05"/>
<text text-anchor="middle" x="698.49" y="-78.35" font-family="Times,serif" font-size="14.00" fill="#28a707">4  [when: pg_user_definition.pgbouncer is defined and pg_user_definition.pgbouncer|bool]</text>
<links><link target="task_ee813fcb-8428-4c54-948f-d8780a1a6356"/></links></g>
</g>
</svg>